<p-card styleClass="px-3">
  <div class="grid">
    <!-- Accommodation pictures -->
    <div class="col-4">
      <smt-slideshow [pictures]="accommodationDetails.pictures" />
    </div>
    <div class="col-8 grid">
      <!-- Accommodation name -->
      <div class="col-12 flex align-items-center">
        <h2 class="my-1">{{ accommodationDetails.name }}</h2>
        <smt-text type="subtitle" className="pt-1 ml-2">
          â€¢ {{ accommodationDetails.type }}
        </smt-text>
      </div>

      <!-- Description -->
      <div class="col-12">
        <p>{{ accommodationDetails.description }}</p>
        <p>{{ accommodationDetails.details }}</p>
      </div>

      <!-- Address -->
      <div class="col flex gap-2">
        <span class="material-icons">place</span>
        <div class="flex flex-column gap-2 mt-1">
          <span><strong>Address</strong></span>
          <span>{{ accommodationDetails.address }}</span>
        </div>
      </div>

      <!-- Distance to center -->
      <div class="col flex gap-2">
        <span class="material-icons">directions_walk</span>
        <div class="flex flex-column gap-2 mt-1">
          <span><strong>Distance to center</strong></span>
          <span>{{ accommodationDetails.distanceToCenterKm }} Km</span>
        </div>
      </div>
    </div>

    <!-- Additional info -->
    <div class="col-12">
      <smt-accommodation-details-info
        [accommodationDetails]="accommodationDetails"
      />
    </div>
    <!-- Available rooms -->
    <div class="grid w-full">
      <div class="col-12">
        <smt-text type="title" text="Available rooms" />
      </div>
      <form [formGroup]="form" class="col-12">
        <p-table [value]="accommodationDetails.rooms">
          <ng-template pTemplate="header">
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Capacity</th>
              <th>Amenities</th>
              <th class="white-space-nowrap">Price / night</th>
              <th>Quantity</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-room let-idx="rowIndex">
            <tr>
              <!-- Room name -->
              <td>{{ room.name }}</td>
              <!-- Room type -->
              <td>
                <p-tag
                  [value]="room.type"
                  [severity]="
                    room.type === 'single'
                      ? 'info'
                      : room.type === 'double'
                        ? 'secondary'
                        : 'contrast'
                  "
                />
              </td>
              <!-- Capacity -->
              <td>
                {{ room.capacity
                }}{{ room.capacity > 1 ? " people" : " person" }}
              </td>
              <!-- Amenities -->
              <td>
                <ul class="pl-0">
                  @for (
                    amenity of room.amenities;
                    let first = $first;
                    track amenity
                  ) {
                    <li [ngClass]="{ 'mt-2': !first }">
                      {{ amenity }}
                    </li>
                  }
                </ul>
              </td>
              <!-- Price -->
              <td>
                {{
                  room.pricePerNight.value
                    | currency: room.pricePerNight.currency
                }}
              </td>
              <!-- Quantity -->
              <td formArrayName="roomQuantities">
                <ng-content />
                <p-dropdown
                  [options]="getQuantityOptions(room.quantity)"
                  [formControlName]="idx"
                  [placeholder]="'Select quantity'"
                  [autoDisplayFirst]="true"
                  optionLabel="label"
                  optionValue="value"
                  [filter]="false"
                  [showClear]="false"
                  [emptyMessage]="'No options'"
                  [appendTo]="'body'"
                >
                </p-dropdown>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </form>
    </div>
  </div>

  <ng-template pTemplate="footer">
    @if (!isAgentView) {
      <div class="w-full text-right">
        <p-button
          label="Next"
          [disabled]="getSelectedRooms().length === 0"
          (onClick)="handleCheckout()"
        />
      </div>
    }
  </ng-template>
</p-card>
